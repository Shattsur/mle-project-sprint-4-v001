# ðŸŽµ ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°
Ð¡ÐµÑ€Ð²Ð¸Ñ Ð¼ÑƒÐ·Ñ‹ÐºÐ°Ð»ÑŒÐ½Ñ‹Ñ… Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ð¹, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð¿Ñ€ÐµÐ´Ð¾ÑÑ‚Ð°Ð²Ð»ÑÐµÑ‚ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð»Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ðµ Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ð¸ Ñ‚Ñ€ÐµÐºÐ¾Ð² Ð½Ð° Ð¾ÑÐ½Ð¾Ð²Ðµ:

**ÐžÑ„Ð»Ð°Ð¹Ð½-Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ð¹ (ALS Ð¼Ð¾Ð´ÐµÐ»ÑŒ + Ð¿Ð¾Ð¿ÑƒÐ»ÑÑ€Ð½Ñ‹Ðµ Ñ‚Ñ€ÐµÐºÐ¸)**  
**ÐžÐ½Ð»Ð°Ð¹Ð½-Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ð¹ (Ð¿Ð¾Ñ…Ð¾Ð¶Ð¸Ðµ Ñ‚Ñ€ÐµÐºÐ¸ Ð½Ð° Ð¾ÑÐ½Ð¾Ð²Ðµ Ð¸ÑÑ‚Ð¾Ñ€Ð¸Ð¸ Ð¿Ñ€Ð¾ÑÐ»ÑƒÑˆÐ¸Ð²Ð°Ð½Ð¸Ð¹)**  
**Ð“Ð¸Ð±Ñ€Ð¸Ð´Ð½Ð¾Ð³Ð¾ Ð¿Ð¾Ð´Ñ…Ð¾Ð´Ð° (Ð¸Ð½Ñ‚ÐµÐ»Ð»ÐµÐºÑ‚ÑƒÐ°Ð»ÑŒÐ½Ð¾Ðµ ÑÐ¼ÐµÑˆÐ¸Ð²Ð°Ð½Ð¸Ðµ Ð¾Ð±Ð¾Ð¸Ñ… Ð¼ÐµÑ‚Ð¾Ð´Ð¾Ð²)**

## ðŸ—ï¸ ÐÑ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð° Ñ€ÐµÑˆÐµÐ½Ð¸Ñ
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    HTTP Ð·Ð°Ð¿Ñ€Ð¾ÑÑ‹    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ÐšÐ»Ð¸ÐµÐ½Ñ‚        â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚   FastAPI        â”‚
â”‚   (Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€/     â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚   Ð¡ÐµÑ€Ð²Ð¸Ñ         â”‚
â”‚   Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ)   â”‚    JSON Ð¾Ñ‚Ð²ÐµÑ‚Ñ‹     â”‚   (Python)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                 â”‚
                                                 â”‚ Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð´Ð°Ð½Ð½Ñ‹Ñ…
                                                 â–¼
                                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                        â”‚   Yandex Cloud S3â”‚
                                        â”‚   (Parquet Ñ„Ð°Ð¹Ð»Ñ‹)â”‚
                                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ðŸš€ Ð‘Ñ‹ÑÑ‚Ñ€Ñ‹Ð¹ ÑÑ‚Ð°Ñ€Ñ‚

### 1. Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚ÐµÐ¹
```bash
# ÐÐºÑ‚Ð¸Ð²Ð°Ñ†Ð¸Ñ Ð²Ð¸Ñ€Ñ‚ÑƒÐ°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ 
# Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð½Ð¾Ð²Ð¾Ðµ Ð²Ð¸Ñ€Ñ‚ÑƒÐ°Ð»ÑŒÐ½Ð¾Ðµ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ðµ Ð¼Ð¾Ð¶Ð½Ð¾ ÐºÐ¾Ð¼Ð°Ð½Ð´Ð¾Ð¹:

python3 -m venv env_recsys_start

# ÐŸÐ¾ÑÐ»Ðµ ÐµÐ³Ð¾ Ð¸Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰ÐµÐ¹ ÐºÐ¾Ð¼Ð°Ð½Ð´Ð¾Ð¹

. env_recsys_start/bin/activate

# Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð¿Ð°ÐºÐµÑ‚Ð¾Ð²
pip install -r requirements.txt
```

### 2. ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ
Ð¡Ð¾Ð·Ð´Ð°Ð¹Ñ‚Ðµ Ñ„Ð°Ð¹Ð» `.env` Ð² ÐºÐ¾Ñ€Ð½Ðµ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°:

```env
AWS_ACCESS_KEY_ID=your_access_key_here
AWS_SECRET_ACCESS_KEY=your_secret_key_here
S3_BUCKET_NAME=s3-student-mle-20250704-4a1b0ab232-freetrack
```

### 3. ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð´Ð°Ð½Ð½Ñ‹Ñ…
```bash
python check_data.py
```

## ðŸ–¥ï¸ Ð—Ð°Ð¿ÑƒÑÐº ÑÐµÑ€Ð²Ð¸ÑÐ°
**Ð¡Ð¿Ð¾ÑÐ¾Ð± 1:**
```bash
python recommendations_service.py
```
**Ð¡Ð¿Ð¾ÑÐ¾Ð± 2:**
```bash
uvicorn recommendations_service:app --host 127.0.0.1 --port 8000 --reload
```
**Ð¡Ð¿Ð¾ÑÐ¾Ð± 3 (Production):**
```bash
uvicorn recommendations_service:app --host 0.0.0.0 --port 8000 --workers 4
```

ÐŸÐ¾ÑÐ»Ðµ Ð·Ð°Ð¿ÑƒÑÐºÐ° ÑÐµÑ€Ð²Ð¸Ñ Ð±ÑƒÐ´ÐµÑ‚ Ð´Ð¾ÑÑ‚ÑƒÐ¿ÐµÐ½ Ð¿Ð¾ Ð°Ð´Ñ€ÐµÑÐ°Ð¼:
- ÐžÑÐ½Ð¾Ð²Ð½Ð¾Ð¹ URL: http://127.0.0.1:8000  
- API Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ: http://127.0.0.1:8000/docs  
- ÐÐ»ÑŒÑ‚ÐµÑ€Ð½Ð°Ñ‚Ð¸Ð²Ð½Ð°Ñ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ: http://127.0.0.1:8000/redoc

## ðŸŒ Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ API
### Ð§ÐµÑ€ÐµÐ· Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€
**ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð·Ð´Ð¾Ñ€Ð¾Ð²ÑŒÑ ÑÐµÑ€Ð²Ð¸ÑÐ°**
```
http://127.0.0.1:8000/health
```

**ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ð¹**
```
http://127.0.0.1:8000/recommend/0
http://127.0.0.1:8000/recommend/123?limit=5
http://127.0.0.1:8000/recommend/456?online_history=53404,33311009
```

**Ð˜Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð¾ Ñ‚Ñ€ÐµÐºÐµ**
```
http://127.0.0.1:8000/track/53404
```

### Ð§ÐµÑ€ÐµÐ· ÐºÐ¾Ð¼Ð°Ð½Ð´Ð½ÑƒÑŽ ÑÑ‚Ñ€Ð¾ÐºÑƒ
```bash
curl http://127.0.0.1:8000/health
curl http://127.0.0.1:8000/recommend/0
curl "http://127.0.0.1:8000/recommend/0?online_history=53404,33311009&limit=5"
curl http://127.0.0.1:8000/track/53404
```

### Ð§ÐµÑ€ÐµÐ· Python
```bash
python test_service.py
```

## ðŸŽ¯ Ð¡Ñ‚Ñ€Ð°Ñ‚ÐµÐ³Ð¸Ñ Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ð¹
### ÐžÑ„Ð»Ð°Ð¹Ð½-Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ð¸
- ÐŸÐµÑ€ÑÐ¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ðµ (ALS): ÐœÐ°Ñ‚Ñ€Ð¸Ñ‡Ð½Ð°Ñ Ñ„Ð°ÐºÑ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð½Ð° Ð¾ÑÐ½Ð¾Ð²Ðµ Ð¸ÑÑ‚Ð¾Ñ€Ð¸Ð¸ Ð¿Ñ€Ð¾ÑÐ»ÑƒÑˆÐ¸Ð²Ð°Ð½Ð¸Ð¹  
- ÐŸÐ¾Ð¿ÑƒÐ»ÑÑ€Ð½Ñ‹Ðµ: Ð¢Ð¾Ð¿-N ÑÐ°Ð¼Ñ‹Ñ… Ð¿Ñ€Ð¾ÑÐ»ÑƒÑˆÐ¸Ð²Ð°ÐµÐ¼Ñ‹Ñ… Ñ‚Ñ€ÐµÐºÐ¾Ð²  
- Ð¡Ð»ÑƒÑ‡Ð°Ð¹Ð½Ñ‹Ðµ: Fallback Ð¸Ð· ÐºÐ°Ñ‚Ð°Ð»Ð¾Ð³Ð° Ñ‚Ñ€ÐµÐºÐ¾Ð²

### ÐžÐ½Ð»Ð°Ð¹Ð½-Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ð¸
- ÐŸÐ¾Ñ…Ð¾Ð¶Ð¸Ðµ Ñ‚Ñ€ÐµÐºÐ¸: ÐÐ° Ð¾ÑÐ½Ð¾Ð²Ðµ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½Ð¸Ñ… 5 Ð¿Ñ€Ð¾ÑÐ»ÑƒÑˆÐ¸Ð²Ð°Ð½Ð¸Ð¹ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ  
- Content-based: Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ð¸ Ð¿Ð¾ ÑÑ…Ð¾Ð¶ÐµÑÑ‚Ð¸ Ð¼ÑƒÐ·Ñ‹ÐºÐ°Ð»ÑŒÐ½Ñ‹Ñ… Ñ…Ð°Ñ€Ð°ÐºÑ‚ÐµÑ€Ð¸ÑÑ‚Ð¸Ðº

### ÐÐ»Ð³Ð¾Ñ€Ð¸Ñ‚Ð¼ ÑÐ¼ÐµÑˆÐ¸Ð²Ð°Ð½Ð¸Ñ
```python
# ÐŸÑ€Ð¾Ð¿Ð¾Ñ€Ñ†Ð¸Ñ: 70% Ð¾Ñ„Ð»Ð°Ð¹Ð½, 30% Ð¾Ð½Ð»Ð°Ð¹Ð½
offline_recs = 70% Ð¾Ñ‚ Ð¾Ð±Ñ‰ÐµÐ³Ð¾ Ð»Ð¸Ð¼Ð¸Ñ‚Ð°
online_recs = 30% Ð¾Ñ‚ Ð¾Ð±Ñ‰ÐµÐ³Ð¾ Ð»Ð¸Ð¼Ð¸Ñ‚Ð°

# ÐŸÑ€Ð¸Ð¾Ñ€Ð¸Ñ‚ÐµÑ‚: Ð¾Ñ„Ð»Ð°Ð¹Ð½ Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ð¸ Ð´Ð¾Ð¼Ð¸Ð½Ð¸Ñ€ÑƒÑŽÑ‚
# Ð ÐµÐ·ÐµÑ€Ð²: Ð¾Ð½Ð»Ð°Ð¹Ð½ Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ð¸ Ð´Ð¾Ð±Ð°Ð²Ð»ÑÑŽÑ‚ Ñ€ÐµÐ»ÐµÐ²Ð°Ð½Ñ‚Ð½Ð¾ÑÑ‚ÑŒ
```

## ðŸ“š API Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ
### GET /health
ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÑÑ‚Ð°Ñ‚ÑƒÑÐ° ÑÐµÑ€Ð²Ð¸ÑÐ° Ð¸ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ð´Ð°Ð½Ð½Ñ‹Ñ…
```json
{
  "status": "healthy",
  "data_loaded": true,
  "timestamp": "2024-01-15T10:30:00"
}
```

### GET /recommend/{user_id}
ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ð¹ Ð´Ð»Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ
ÐŸÐ°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹:
- `user_id` â€” Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹ ID Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ  
- `limit` â€” ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ð¹ (Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ 10)  
- `online_history` â€” ID Ñ‚Ñ€ÐµÐºÐ¾Ð² Ñ‡ÐµÑ€ÐµÐ· Ð·Ð°Ð¿ÑÑ‚ÑƒÑŽ Ð´Ð»Ñ Ð¾Ð½Ð»Ð°Ð¹Ð½-Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ð¹

### GET /track/{track_id}
ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ð¸ Ð¾ Ñ‚Ñ€ÐµÐºÐµ
```json
{
  "track_name": "Smells Like Teen Spirit",
  "artist_names": ["Nirvana"],
  "genre_names": ["alternative", "rock", "allrock"]
}
```

## ðŸ› ï¸ Ð¢Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸Ñ
### Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð½Ñ‹Ðµ Ñ‚Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸Ñ
- Python 3.8+
- 4GB+ RAM
- 1GB+ ÑÐ²Ð¾Ð±Ð¾Ð´Ð½Ð¾Ð³Ð¾ Ð¼ÐµÑÑ‚Ð°

### Python Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸
```txt
fastapi==0.104.1
uvicorn==0.24.0
pandas==2.1.3
numpy==1.24.3
python-dotenv==1.0.0
boto3==1.28.62
requests==2.31.0
pyarrow==14.0.1
pydantic==2.5.0
```

## ðŸ“ Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°
```
mle-project-sprint-4-v001/
â”œâ”€â”€ recommendations_service.py
â”œâ”€â”€ test_service.py
â”œâ”€â”€ check_data.py
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ .env
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ items.parquet
â”‚   â”œâ”€â”€ similar.parquet
â”‚   â”œâ”€â”€ personal_als.parquet
â”‚   â””â”€â”€ top_popular.parquet
â””â”€â”€ test_service.log
```

## ðŸ”§ Ð£ÑÑ‚Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ Ð½ÐµÐ¿Ð¾Ð»Ð°Ð´Ð¾Ðº
**ÐŸÑ€Ð¾Ð±Ð»ÐµÐ¼Ð°:** "ÐÐµ ÑƒÐ´Ð°ÐµÑ‚ÑÑ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð´Ð¾ÑÑ‚ÑƒÐ¿ Ðº ÑÐ°Ð¹Ñ‚Ñƒ"  
**Ð ÐµÑˆÐµÐ½Ð¸Ðµ:** Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ `http://127.0.0.1:8000`

**ÐŸÑ€Ð¾Ð±Ð»ÐµÐ¼Ð°:** ÐžÑˆÐ¸Ð±ÐºÐ¸ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ Ðº S3  
**Ð ÐµÑˆÐµÐ½Ð¸Ðµ:** ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ `.env` Ð¸ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾ÑÑ‚ÑŒ Ð±Ð°ÐºÐµÑ‚Ð°

**ÐŸÑ€Ð¾Ð±Ð»ÐµÐ¼Ð°:** "Port already in use"  
**Ð ÐµÑˆÐµÐ½Ð¸Ðµ:**  
```bash
uvicorn recommendations_service:app --host 127.0.0.1 --port 8080
```

## ðŸ“Š ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ Ð¸ Ð»Ð¾Ð³Ð¸
Ð¡ÐµÑ€Ð²Ð¸Ñ Ð»Ð¾Ð³Ð¸Ñ€ÑƒÐµÑ‚ ÐºÐ»ÑŽÑ‡ÐµÐ²Ñ‹Ðµ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ñ:
- Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¿Ñ€Ð¸ ÑÑ‚Ð°Ñ€Ñ‚Ðµ
- Ð—Ð°Ð¿Ñ€Ð¾ÑÑ‹ Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ð¹
- ÐžÑˆÐ¸Ð±ÐºÐ¸ Ð¸ Ð¿Ñ€ÐµÐ´ÑƒÐ¿Ñ€ÐµÐ¶Ð´ÐµÐ½Ð¸Ñ

```bash
python recommendations_service.py > service.log 2>&1
```
